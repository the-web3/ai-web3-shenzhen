# AI Wallet - 安全改进建议

## 当前状态
- ✅ 私钥使用 AES-256-GCM 加密
- ✅ Passkey 生物识别认证
- ⚠️ 私钥托管在服务器
- ⚠️ MASTER_SECRET 存储在 .env 文件

## 短期改进 (1-2天)

### 1. 添加私钥导出功能
- [ ] 在前端添加"导出私钥"按钮（需二次认证）
- [ ] 显示 MetaMask 导入教程
- [ ] 添加导出日志记录

### 2. 增强密钥管理
- [ ] 将 MASTER_SECRET 移到环境变量/密钥管理服务
- [ ] 不要将 .env 提交到 Git
- [ ] 定期轮换 MASTER_SECRET（需要重新加密所有私钥）

### 3. 审计日志
- [ ] 记录所有私钥访问（解密、签名）
- [ ] 记录异常登录尝试
- [ ] 实时监控可疑活动

## 中期改进 (1-2周)

### 4. 实现真正的 AA 钱包
- [ ] 部署 ERC-4337 Factory 合约
- [ ] 实现 CREATE2 地址计算
- [ ] 支持社交恢复（多个守护者）
- [ ] Gas 赞助（用户无需持有 ETH）

### 5. 多重签名
- [ ] 要求大额转账需要多重确认
- [ ] 支持硬件钱包作为第二签名者
- [ ] 时间锁（大额转账延迟执行）

### 6. 客户端加密选项
- [ ] 允许用户选择"自我托管"模式
- [ ] 私钥在浏览器本地加密
- [ ] 服务器只存储加密后的密钥

## 长期改进 (1个月+)

### 7. MPC 钱包
- [ ] 研究 MPC 方案（如 Fireblocks, Qredo）
- [ ] 私钥分片到多个节点
- [ ] TSS (门限签名方案)

### 8. 零知识证明
- [ ] 用户可验证服务器没有滥用私钥
- [ ] 隐私保护的交易验证

### 9. 去中心化备份
- [ ] 使用 IPFS 加密备份
- [ ] Shamir 秘密共享（分片恢复）

## 合规性考虑

如果作为商业产品：
- [ ] 咨询法律顾问（托管钱包的监管要求）
- [ ] 考虑申请相关牌照
- [ ] 实施 KYC/AML 流程
- [ ] 购买网络安全保险

## 当前用户建议

**立即行动**:
1. 使用导出工具导出私钥
2. 导入到 MetaMask 备份
3. 不要在生产环境使用此钱包管理大额资金
4. 仅用于测试和小额交易

**命令**:
```bash
cd backend/cmd/export_key
go run main.go --export
# 将生成 wallet_keys_YYYYMMDD_HHMMSS.txt 文件
```
